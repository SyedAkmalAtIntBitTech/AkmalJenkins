/**
 * plugin.js
 *
 * Released under LGPL License.
 * Copyright (c) 1999-2015 Ephox Corp. All rights reserved
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */

/*global tinymce:true */

tinymce.PluginManager.add('custombutton', function (editor) {
//    editor.addButton('custombutton', {
//        image: '../images/trash.svg',
//        tooltip: 'Delete',
//        onclick: function () {
//            alert(editor.getContent());
//      }
//    });
    editor.addButton('fileuploader', {
        text: 'Upload Image',
        icon: false,
        onclick: function() {
            // Open window with a specific url
            editor.windowManager.open({
                title: 'Upload Image',
                file: 'custompopup.html',
                width: 900,
                height: 500,
                buttons: [{
                    text: 'Done',
                    onclick: function(e) {
                        // .......working get data from iframe open
                        var frame = $(e.currentTarget).find("iframe").get(0);
                        var content = frame.contentDocument;
                        var imageSrc = $(content).find("#imageDiv").val();
                        //.............
                        
                        // .......add image to selected element
                            alert(dom.getAttrib(imgElm, 'style'))
                      var  imgHTML = '<img src="'+imageSrc+'" />';
                        top.tinymce.activeEditor.insertContent(imgHTML);
                        top.tinymce.activeEditor.windowManager.close();
                    }
                }]
            });
        }
    });
    

});
